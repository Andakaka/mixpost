import{r as v,i as K,s as R,a4 as N,W as le,x as z,y as ne,o as i,c as y,F as T,e as Q,g as j,f as F,t as W,b,n as O,m as P,Q as ae,h as C,O as oe,a5 as M,a as $,a6 as re,u as a,w,_ as X,k as Y}from"./app.cba077cd.js";import{_ as A,a as Z}from"./NoResult.d2b25224.js";import{l as ee,k as ie,h as ce,_ as te}from"./SearchInput.f879e939.js";import{u as ue}from"./useNotifications.09007a43.js";const q=(t="mixpost.media.fetchUploads")=>{const{notify:o}=ue(),u=v("uploads"),r=K(()=>({uploads:"Upload",stock:"Stock Photos",gifs:"GIFs"})),S=v(!1),l=v(!1),k=v(!1),x=v(1),h=v([]),p=v(null),n=v(""),d=v([]),f=g=>{const m=d.value.findIndex(e=>e.id===g.id);m<0&&!g.hasOwnProperty("error")&&d.value.push(g),m>=0&&d.value.splice(m,1)},_=()=>{d.value=[]},s=g=>d.value.findIndex(e=>e.id===g.id)!==-1,D=(g=!0)=>{!x.value||(N.start(),axios.get(route(t),{params:{page:x.value,keyword:n.value}}).then(function(m){const e=m.data.links.next;e&&(x.value=m.data.links.next.split("?page=")[1]),e||(x.value=0),g||(h.value=m.data.data),g&&(h.value=[...h.value,...m.data.data])}).catch(()=>{o("error","Error retrieving media. Try again!")}).finally(()=>{N.done(),N.remove(),S.value=!0}))},U=(g,m)=>{l.value=!0,N.start(),axios.post(route("mixpost.media.download"),{items:g}).then(e=>{m(e)}).catch(()=>{o("error","Error downloading media. Try again!")}).finally(()=>{l.value=!1,N.done(),N.remove()})},B=g=>{h.value=h.value.filter(m=>!g.includes(m.id))},J=(g,m)=>{k.value=!0,N.start(),axios.delete(route("mixpost.media.delete"),{data:{items:g}}).then(()=>{m()}).catch(()=>{o("error","Error deleting media. Try again!")}).finally(()=>{k.value=!1,N.done(),N.remove()})},V=()=>{const g=new IntersectionObserver(m=>{m[0].isIntersecting&&D()});le(()=>{g.observe(p.value)})};return R(n,ee.exports.debounce(()=>{x.value=1,D(!1)},300)),{activeTab:u,tabs:r,isLoaded:S,isDownloading:l,isDeleting:k,keyword:n,page:x,items:h,endlessPagination:p,selected:d,downloadExternal:U,deletePermanently:J,removeItems:B,createObserver:V,toggleSelect:f,deselectAll:_,isSelected:s}};let de=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((o,u)=>(u&=63,u<36?o+=u.toString(36):u<62?o+=(u-26).toString(36).toUpperCase():u>62?o+="-":o+="_",o),"");const me=["data-column"],E={__name:"Masonry",props:{items:{type:Array,required:!0},columns:{type:Number,default:3}},setup(t){const o=t,u=v(null),r=v([]),S=v(!1);z(()=>{p(),window.addEventListener("resize",l)}),ne(()=>{window.removeEventListener("resize",l)});const l=ee.exports.debounce(()=>{r.value.length!==k().length&&p()},300),k=()=>{let n=o.columns;ie().width<=768&&(n=2);const d=[];for(let f=0;f<n;f++)d.push({i:f,indexes:[]});return d},x=n=>{const d=n%r.value.length;r.value[d].indexes.push(n)},h=()=>{for(let n=0;n<o.items.length;n++)x(n)},p=()=>{S.value=!1,r.value.splice(0),r.value.push(...k()),S.value=!0,h()};return R(()=>o.items,()=>{p()}),(n,d)=>(i(),y("div",{class:O(["flex -m-1",{"opacity-0":!S.value}])},[(i(!0),y(T,null,Q(r.value,(f,_)=>(i(),y("div",{class:"flex flex-col grow basis-0 px-1",key:_},[(i(!0),y(T,null,Q(f.indexes,s=>(i(),y("div",{class:"py-1",key:s,ref_for:!0,ref:`item_${s}`},[j(n.$slots,"default",{item:t.items[s],index:s},()=>[F(W(t.items[s]),1)])]))),128)),b("div",{class:"grow -mt-20 pt-20 min-h-[100px] -z-10",ref_for:!0,ref_key:"bottomRef",ref:u,"data-column":_},null,8,me)]))),128))],2))}},L={__name:"MediaSelectable",props:{active:{type:Boolean,default:!1}},emits:["click"],setup(t){return(o,u)=>(i(),y("div",{onClick:u[0]||(u[0]=r=>o.$emit("click")),class:"w-full relative cursor-pointer box-border"},[j(o.$slots,"default"),b("div",{class:O(["absolute flex items-center justify-center top-0 right-0 mr-sm mt-sm w-7 h-7 rounded-full border border-white",{"bg-indigo-500":t.active,"bg-black bg-opacity-20":!t.active}])},[t.active?(i(),P(ae,{key:0,class:"text-white"})):C("",!0)],2)]))}},fe=["onDrop"],ve={class:"relative flex flex-col justify-center"},pe=b("div",{class:"text-center mb-1"},[F("Drag & drop files here, or "),b("label",{for:"browse",class:"cursor-pointer text-indigo-500 hover:text-indigo-700 active:text-indigo-700 focus:outline-none focus:text-indigo-700 transition-colors ease-in-out duration-200"}," Browse ")],-1),ge={class:"text-sm text-gray-400 text-center"},he=["accept"],_e={key:0,class:"mt-lg"},ye={__name:"UploadMedia",props:{maxSelection:{type:Number,default:1},combinesMimeTypes:{type:String,default:""},selected:{type:Array,default:[]},toggleSelect:{type:Function},isSelected:{type:Function},columns:{type:Number,default:3}},emits:["mediaSelect"],setup(t,{emit:o}){const u=t,r=oe().props.value.mixpost.mime_types,S=v(null),l=v(!1),k=e=>{if(p.value)return;l.value=!1;const c=h(e.dataTransfer.files);c.length&&V(c)},x=e=>{const c=h(e.target.files);c.length&&(S.value.value=null,V(c))},h=e=>Array.from(e).filter(c=>r.includes(c.type)),p=v(!1),n=v([]),d=v([]),f=v({});R(f,()=>{_(),p.value=Object.keys(f.value).length>0});const _=()=>{f.value.handler&&f.value.handler()},s=e=>{n.value.push(e),Object.keys(f.value).length===0&&D()},D=e=>{Object.keys(f.value).length>0&&(J(f.value,e),u.toggleSelect&&u.toggleSelect(e)),n.value.length>0?(U(n.value[0]),B()):U({})},U=e=>{f.value=e},B=()=>{n.value.shift()},J=(e,c)=>{d.value.push(Object.assign(e,{media:c}))},V=e=>{e.forEach(c=>{s({id:de(),handler:async()=>{await g(c).then(I=>{D(I)}).catch(I=>{D({name:c.name,error:I.response.data.message})})}})})},g=e=>{const c=new FormData;return c.append("file",e),new Promise((I,H)=>{axios.post(route("mixpost.media.upload"),c).then(function(G){I(G.data)}).catch(function(G){H(G)})})},m=K(()=>d.value.filter(()=>!0).reverse());return v([]),(e,c)=>(i(),y(T,null,[b("div",{onDragenter:c[2]||(c[2]=M(I=>l.value=!p.value,["prevent"])),onDrop:M(k,["prevent"]),onDragover:c[3]||(c[3]=M(()=>{},["prevent"])),class:O([{"border-gray-700 bg-white":!l.value,"border-cyan-500 bg-cyan-50":l.value},"relative w-full flex items-center justify-center rounded-lg p-10 border-2 border-dashed transition-colors ease-in-out duration-200"])},[b("div",ve,[l.value?(i(),y("div",{key:0,onDragleave:c[0]||(c[0]=M(I=>l.value=!1,["prevent"])),onDragover:c[1]||(c[1]=M(()=>{},["prevent"])),class:"w-full h-full absolute"},null,32)):C("",!0),$(re,{class:O([{"text-stone-700":!l.value,"text-cyan-500":l.value},"!w-16 !h-16 mx-auto mb-xs transition-colors ease-in-out duration-200"])},null,8,["class"]),pe,b("div",ge,W(a(r).join(", ")),1)]),p.value?(i(),P(ce,{key:0,size:"xl",class:"rounded-lg"})):C("",!0)],42,fe),b("input",{ref_key:"input",ref:S,id:"browse",type:"file",accept:a(r).join(","),multiple:"multiple",class:"hidden",onChange:x},null,40,he),a(m).length?(i(),y("div",_e,[$(E,{items:a(m),columns:t.columns},{default:w(({item:I})=>[$(L,{active:t.isSelected(I.media),onClick:H=>t.toggleSelect(I.media)},{default:w(()=>[$(A,{media:I.media},null,8,["media"])]),_:2},1032,["active","onClick"])]),_:1},8,["items","columns"])])):C("",!0)],64))}},xe={},be={class:"w-full text-lg"};function ke(t,o){return i(),y("div",be,[j(t.$slots,"default")])}const we=X(xe,[["render",ke]]),$e=F("Library"),Le={__name:"MediaUploads",props:{columns:{type:Number,default:3}},setup(t,{expose:o}){const{page:u,items:r,endlessPagination:S,selected:l,toggleSelect:k,deselectAll:x,removeItems:h,isSelected:p,createObserver:n}=q();return z(()=>{n()}),o({selected:l,deselectAll:x,removeItems:h}),(d,f)=>(i(),y(T,null,[$(ye,{"max-selection":4,"combines-mime-types":"",selected:a(l),toggleSelect:a(k),isSelected:a(p),columns:t.columns},null,8,["selected","toggleSelect","isSelected","columns"]),b("div",{class:O({"mt-lg":a(r).length})},[a(r).length?(i(),y(T,{key:0},[$(we,{class:"mb-4"},{default:w(()=>[$e]),_:1}),$(E,{items:a(r),columns:t.columns},{default:w(({item:_})=>[_?(i(),P(L,{key:0,active:a(p)(_),onClick:s=>a(k)(_)},{default:w(()=>[$(A,{media:_},null,8,["media"])]),_:2},1032,["active","onClick"])):C("",!0)]),_:1},8,["items","columns"])],64)):C("",!0),b("div",{ref_key:"endlessPagination",ref:S,class:"-z-10 w-full"},null,512)],2)],64))}},Se={},Ce={class:"absolute z-10 bottom-0 mb-xs left-0 ml-xs hidden group-hover:block"},Ie={class:"bg-white shadow-mix py-xs px-sm text-left rounded-md"};function Ne(t,o){return i(),y("div",Ce,[b("div",Ie,[j(t.$slots,"default")])])}const se=X(Se,[["render",Ne]]),De={key:0,class:"mt-lg"},Pe=b("div",null,"Image from Unsplash",-1),Te=F("By "),Fe=["href"],Me=F("No images found."),Be={__name:"MediaStock",props:{columns:{type:Number,default:3}},setup(t,{expose:o}){const{isLoaded:u,keyword:r,page:S,items:l,endlessPagination:k,selected:x,toggleSelect:h,deselectAll:p,isSelected:n,createObserver:d}=q("mixpost.media.fetchStock");return z(()=>{d()}),o({selected:x,deselectAll:p}),(f,_)=>(i(),y(T,null,[$(te,{modelValue:a(r),"onUpdate:modelValue":_[0]||(_[0]=s=>Y(r)?r.value=s:null),placeholder:"Search Unsplash"},null,8,["modelValue"]),a(l).length?(i(),y("div",De,[$(E,{items:a(l),columns:t.columns},{default:w(({item:s})=>[s?(i(),P(L,{key:0,active:a(n)(s),onClick:D=>a(h)(s)},{default:w(()=>[$(A,{media:s,class:"group"},{default:w(()=>[$(se,null,{default:w(()=>[Pe,b("div",null,[Te,b("a",{href:s.credit_url,target:"_blank",class:"link"},W(s.name),9,Fe)])]),_:2},1024)]),_:2},1032,["media"])]),_:2},1032,["active","onClick"])):C("",!0)]),_:1},8,["items","columns"])])):C("",!0),a(u)&&!a(l).length?(i(),P(Z,{key:1,class:"mt-lg"},{default:w(()=>[Me]),_:1})):C("",!0),b("div",{ref_key:"endlessPagination",ref:k,class:"-z-10 w-full"},null,512)],64))}},Oe={key:0,class:"mt-lg"},Ue=F(" GIF from Tenor "),Ve=F("No GIFs found."),Je={__name:"MediaGifs",props:{columns:{type:Number,default:3}},setup(t,{expose:o}){const{isLoaded:u,keyword:r,page:S,items:l,endlessPagination:k,selected:x,toggleSelect:h,deselectAll:p,isSelected:n,createObserver:d}=q("mixpost.media.fetchGifs");return z(()=>{d()}),o({selected:x,deselectAll:p}),(f,_)=>(i(),y(T,null,[$(te,{modelValue:a(r),"onUpdate:modelValue":_[0]||(_[0]=s=>Y(r)?r.value=s:null),placeholder:"Search Tenor GIFs"},null,8,["modelValue"]),a(l).length?(i(),y("div",Oe,[$(E,{items:a(l),columns:t.columns},{default:w(({item:s})=>[s?(i(),P(L,{key:0,active:a(n)(s),onClick:D=>a(h)(s)},{default:w(()=>[(i(),P(A,{media:s,key:s.id,class:"group"},{default:w(()=>[$(se,null,{default:w(()=>[Ue]),_:1})]),_:2},1032,["media"]))]),_:2},1032,["active","onClick"])):C("",!0)]),_:1},8,["items","columns"])])):C("",!0),a(u)&&!a(l).length?(i(),P(Z,{key:1,class:"mt-lg"},{default:w(()=>[Ve]),_:1})):C("",!0),b("div",{ref_key:"endlessPagination",ref:k,class:"-z-10 w-full"},null,512)],64))}};export{Le as _,Be as a,Je as b,q as u};
